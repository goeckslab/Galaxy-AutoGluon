{
  "train_metrics": {
    "accuracy": 0.7161198288159771,
    "balanced_accuracy": 0.28915988824254607,
    "f1_macro": 0.288312373446211,
    "f1_micro": 0.7161198288159771,
    "f1_weighted": 0.6579853799088609,
    "precision_macro": 0.43475424885972774,
    "precision_micro": 0.7161198288159771,
    "precision_weighted": 0.6420073963609376,
    "recall_macro": 0.28915988824254607,
    "recall_micro": 0.7161198288159771,
    "recall_weighted": 0.7161198288159771,
    "log_loss": 0.7111032220484134,
    "roc_auc_ovr": 0.8952663840337299,
    "roc_auc_ovo": 0.82244517578625,
    "mcc": 0.37723212358404856,
    "quadratic_kappa": 0.47361438845481474,
    "y_true": "6832    bkl\n3471     nv\n3389     nv\n4130     nv\n4990     nv\n       ... \n4095     nv\n3131     nv\n1491     nv\n2356     nv\n1239    mel\nName: dx, Length: 5608, dtype: object",
    "y_pred": "6832    bkl\n3471     nv\n3389     nv\n4130     nv\n4990     nv\n       ... \n4095     nv\n3131     nv\n1491     nv\n2356     nv\n1239    bkl\nName: dx, Length: 5608, dtype: object",
    "y_prob": "         akiec       bcc       bkl        df       mel        nv      vasc\n6832  0.163515  0.292210  0.329504  0.003152  0.174401  0.031177  0.006041\n3471  0.000029  0.000012  0.000131  0.000100  0.000082  0.999559  0.000087\n3389  0.002476  0.001179  0.005976  0.000916  0.010339  0.925457  0.053658\n4130  0.008912  0.022471  0.146672  0.035891  0.158978  0.616306  0.010771\n4990  0.000043  0.000058  0.000266  0.000047  0.000271  0.999076  0.000238\n...        ...       ...       ...       ...       ...       ...       ...\n4095  0.000019  0.000015  0.000114  0.000054  0.000160  0.999559  0.000078\n3131  0.000033  0.000017  0.000134  0.000120  0.000081  0.999530  0.000084\n1491  0.000019  0.000017  0.000104  0.000083  0.000150  0.999575  0.000052\n2356  0.014661  0.111198  0.147638  0.002675  0.246524  0.467364  0.009940\n1239  0.173887  0.203891  0.311049  0.004437  0.200926  0.097372  0.008436\n\n[5608 rows x 7 columns]"
  },
  "validation_metrics": {
    "accuracy": 0.7232524964336662,
    "balanced_accuracy": 0.32509199472106926,
    "f1_macro": 0.31286972009575414,
    "f1_micro": 0.7232524964336662,
    "f1_weighted": 0.6684998083054512,
    "precision_macro": 0.35871380817423987,
    "precision_micro": 0.7232524964336662,
    "precision_weighted": 0.6442299331329905,
    "recall_macro": 0.32509199472106926,
    "recall_micro": 0.7232524964336662,
    "recall_weighted": 0.7232524964336662,
    "log_loss": 0.7091415517922169,
    "roc_auc_ovr": 0.8930528838229274,
    "roc_auc_ovo": 0.8115336312990865,
    "mcc": 0.399319450027419,
    "quadratic_kappa": 0.4645372072617724,
    "y_true": "2370     nv\n1339     nv\n3215     nv\n6400     nv\n6885    mel\n       ... \n1510     nv\n4978     nv\n335     bkl\n4832    mel\n5143     nv\nName: dx, Length: 1402, dtype: object",
    "y_pred": "2370     nv\n1339     nv\n3215     nv\n6400     nv\n6885     nv\n       ... \n1510     nv\n4978     nv\n335      nv\n4832    mel\n5143     nv\nName: dx, Length: 1402, dtype: object",
    "y_prob": "         akiec       bcc       bkl        df       mel        nv      vasc\n2370  0.000014  0.000014  0.000114  0.000014  0.000134  0.999574  0.000135\n1339  0.000026  0.000017  0.000222  0.000035  0.000141  0.999343  0.000216\n3215  0.000045  0.000023  0.000144  0.000040  0.000243  0.999324  0.000181\n6400  0.000017  0.000014  0.000109  0.000068  0.000125  0.999624  0.000042\n6885  0.017021  0.223764  0.200483  0.002347  0.245997  0.298472  0.011917\n...        ...       ...       ...       ...       ...       ...       ...\n1510  0.001735  0.000991  0.046166  0.006269  0.000889  0.901378  0.042572\n4978  0.000043  0.000020  0.000306  0.000046  0.000323  0.998971  0.000292\n335   0.001978  0.000647  0.255024  0.014202  0.000507  0.689177  0.038465\n4832  0.048342  0.102910  0.196689  0.004405  0.361414  0.269236  0.017003\n5143  0.000025  0.000009  0.000142  0.000031  0.000178  0.999372  0.000242\n\n[1402 rows x 7 columns]"
  },
  "test_metrics": {
    "accuracy": 0.7108153078202994,
    "balanced_accuracy": 0.28141965068268887,
    "f1_macro": 0.28770752745851247,
    "f1_micro": 0.7108153078202994,
    "f1_weighted": 0.654955115350805,
    "precision_macro": 0.4275916658631441,
    "precision_micro": 0.7108153078202994,
    "precision_weighted": 0.6417551365866209,
    "recall_macro": 0.28141965068268887,
    "recall_micro": 0.7108153078202994,
    "recall_weighted": 0.7108153078202994,
    "log_loss": 0.7345515782378423,
    "roc_auc_ovr": 0.8827529730306629,
    "roc_auc_ovo": 0.8018785130071547,
    "mcc": 0.37105391166289864,
    "quadratic_kappa": 0.4584141901275426,
    "y_true": "0       mel\n1        nv\n2       mel\n3       bkl\n4        nv\n       ... \n3000     nv\n3001     nv\n3002     nv\n3003    mel\n3004    mel\nName: dx, Length: 3005, dtype: object",
    "y_pred": "0        bkl\n1         nv\n2         nv\n3       vasc\n4         nv\n        ... \n3000      nv\n3001      nv\n3002      nv\n3003      nv\n3004      nv\nName: dx, Length: 3005, dtype: object",
    "y_prob": "         akiec       bcc       bkl        df       mel        nv      vasc\n0     0.248437  0.198749  0.371132  0.003441  0.130279  0.040775  0.007187\n1     0.004455  0.018002  0.097270  0.036038  0.160292  0.675515  0.008429\n2     0.016436  0.132537  0.161124  0.002820  0.259875  0.416904  0.010305\n3     0.000890  0.001643  0.152172  0.038638  0.002203  0.357632  0.446822\n4     0.006112  0.024722  0.051833  0.002324  0.118002  0.781968  0.015039\n...        ...       ...       ...       ...       ...       ...       ...\n3000  0.000018  0.000010  0.000113  0.000023  0.000101  0.999513  0.000222\n3001  0.012477  0.066689  0.059182  0.002792  0.242660  0.608858  0.007342\n3002  0.000031  0.000011  0.000135  0.000102  0.000090  0.999543  0.000089\n3003  0.008935  0.085629  0.121022  0.002218  0.211263  0.562066  0.008866\n3004  0.015450  0.029693  0.185571  0.035158  0.163766  0.557541  0.012821\n\n[3005 rows x 7 columns]"
  },
  "config": "{'model': {'names': ['ft_transformer'], 'ft_transformer': {'data_types': ['categorical', 'numerical'], 'embedding_arch': ['linear'], 'token_dim': 192, 'hidden_size': 192, 'num_blocks': 3, 'attention_num_heads': 8, 'attention_dropout': 0.2, 'residual_dropout': 0.0, 'ffn_dropout': 0.1, 'ffn_hidden_size': 192, 'ffn_activation': 'geglu', 'head_activation': 'relu', 'normalization': 'layer_norm', 'merge': 'concat', 'requires_all_dtypes': False, 'additive_attention': False, 'share_qv_weights': False, 'pooling_mode': 'cls', 'checkpoint_name': None}}, 'data': {'image': {'missing_value_strategy': 'zero'}, 'text': {'normalize_text': False}, 'categorical': {'minimum_cat_count': 100, 'maximum_num_cat': 20, 'convert_to_text': False, 'convert_to_text_template': 'latex'}, 'numerical': {'convert_to_text': False, 'scaler_with_mean': True, 'scaler_with_std': True}, 'document': {'missing_value_strategy': 'zero'}, 'label': {'numerical_preprocessing': 'standardscaler'}, 'pos_label': None, 'column_features_pooling_mode': 'concat', 'mixup': {'turn_on': False, 'mixup_alpha': 0.8, 'cutmix_alpha': 1.0, 'cutmix_minmax': None, 'prob': 1.0, 'switch_prob': 0.5, 'mode': 'batch', 'turn_off_epoch': 5, 'label_smoothing': 0.1}, 'modality_dropout': 0, 'templates': {'turn_on': False, 'num_templates': 30, 'template_length': 2048, 'preset_templates': ['super_glue', 'rte'], 'custom_templates': None}}, 'optim': {'optim_type': 'adamw', 'lr': 0.0001, 'weight_decay': 0.001, 'lr_choice': 'layerwise_decay', 'lr_decay': 0.9, 'lr_schedule': 'cosine_decay', 'max_epochs': 20, 'max_steps': -1, 'warmup_steps': 0.1, 'end_lr': 0, 'lr_mult': 1, 'patience': 10, 'val_check_interval': 0.5, 'check_val_every_n_epoch': 1, 'skip_final_val': False, 'gradient_clip_val': 1, 'gradient_clip_algorithm': 'norm', 'track_grad_norm': -1, 'log_every_n_steps': 10, 'label_smoothing': 0, 'top_k': 3, 'top_k_average_method': 'greedy_soup', 'peft': None, 'lora': {'module_filter': None, 'filter': ['query', 'value', '^q$', '^v$', '^k$', '^o$'], 'r': 8, 'alpha': 8, 'conv_lora_expert_num': 8}, 'loss_func': 'auto', 'focal_loss': {'alpha': None, 'gamma': 2.0, 'reduction': 'mean'}, 'mask2former_loss': {'loss_cross_entropy_weight': 10.0, 'loss_mask_weight': 5.0, 'loss_dice_weight': 5.0}, 'extra_trainable_params': [], 'cross_modal_align': None, 'cross_modal_align_weight': 0, 'automatic_optimization': True, 'lemda': {'turn_on': False, 'arch_type': 'mlp_vae', 'z_dim': 8, 'num_layers': 6, 'kld_weight': 0.1, 'mse_weight': 0.1, 'adv_weight': 0.0001, 'consist_weight': 0.01, 'consist_threshold': 0.5, 'lr': 0.0001, 'optim_type': 'adamw', 'weight_decay': 1e-05}}, 'env': {'num_gpus': 1, 'num_nodes': 1, 'batch_size': 128, 'per_gpu_batch_size': 8, 'inference_batch_size_ratio': 4, 'precision': '16-mixed', 'num_workers': 2, 'num_workers_inference': 2, 'accelerator': 'auto', 'fast_dev_run': False, 'deterministic': False, 'auto_select_gpus': True, 'strategy': 'auto', 'deepspeed_allgather_size': 1000000000.0, 'deepspeed_allreduce_size': 1000000000.0, 'compile': {'turn_on': False, 'mode': 'default', 'dynamic': True, 'backend': 'inductor'}}, 'random_seed': 42, 'time_limit': 60, 'problem_type': 'multiclass'}"
}